#!/bin/bash
#$1 package name, $2 project name, $3 class name, $4 the testing tool to use

RED=$(tput setaf 1) #colors
NORMAL=$(tput sgr0)

project_root=$(pwd)
dir="$project_root/subjects/$2"

if [ ! -d "$dir/build" ]; then  #compile if not done yet
    cd $dir
    echo -n | ./gradlew -q -Dskip.tests jar
    cd $project_root
fi

full_class_package=$1.$3

#generate tests
if [ $4 == "randoop" ]; then
    project_classpath="$dir/build/libs/*:$dir/libs/*:"
    ./scripts/randoop_tests $full_class_package $project_classpath $2 $1
elif [ $4 == "evosuite" ]; then
    project_compilation_path="$dir/build/classes/java/main/:$dir/build/libs/simple-examples-1.0-SNAPSHOT.jar:"
    ./scripts/evosuite_tests $full_class_package $project_compilation_path $2
else
    echo -e "\n\n\n${RED}invalid testing tool provided, expected randoop or evosuite, but received $4 ${NORMAL}\n"
fi
