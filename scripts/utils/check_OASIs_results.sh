#!/bin/bash

#removes the current subject from the list of subjects to execute with OASIs
#$1 subject name
function remove_from_subject_list() {
    grep -vwE "$1" $next_subjects_to_check > tmp_subjects_swap_var.txt
    cp tmp_subjects_swap_var.txt $next_subjects_to_check
}

#moves the temporal result generated by OASIs to a folder of permanent results
function save_results() {
    rm -r -f $output_dir
    cp -r $tmp_output_dir $output_dir
}

#$1 folder with temporal result, $2 folder for general results, $3 subject name

#handles the results generated by OASIs during the executions in the loop
#saves the result if it's more significant than the previous

next_subjects_to_check=resources/next_subjects_to_check.txt
tmp_output_dir=$1
output_dir=$2
OASIs_log_file=$tmp_output_dir/OASIslog.txt

if [ $(grep "^False Positive Detected" $OASIs_log_file | wc -l) -ge 1 ]; then
    remove_from_subject_list $3
    save_results
elif [ $(grep "^False Negative Detected" $OASIs_log_file | wc -l) -ge 1 ]; then
    save_results
elif [ ! -f "$OASIs_log_file" ]; then
    save_results
fi

